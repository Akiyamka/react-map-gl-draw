{"version":3,"file":"react-map-gl-draw.cjs.js","sources":["../node_modules/@mapbox/mapbox-gl-draw/src/lib/theme.js","../node_modules/@mapbox/mapbox-gl-draw/src/constants.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/common_selectors.js","../node_modules/@mapbox/point-geometry/index.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/mouse_event_point.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/create_vertex.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/create_midpoint.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/create_supplementary_points.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/string_set.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/double_click_zoom.js","../node_modules/@mapbox/geojson-normalize/index.js","../node_modules/geojson-flatten/dist/index.js","../node_modules/@mapbox/geojson-coords/flatten.js","../node_modules/@mapbox/geojson-coords/index.js","../node_modules/traverse/index.js","../node_modules/@mapbox/extent/index.js","../node_modules/@mapbox/geojson-extent/index.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/constrain_feature_movement.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/move_features.js","../node_modules/@mapbox/mapbox-gl-draw/src/modes/simple_select.js","../node_modules/@mapbox/mapbox-gl-draw/src/modes/direct_select.js","../node_modules/@mapbox/mapbox-gl-draw/src/modes/draw_point.js","../node_modules/@mapbox/mapbox-gl-draw/src/lib/is_event_at_coordinates.js","../node_modules/@mapbox/mapbox-gl-draw/src/modes/draw_polygon.js","../node_modules/@mapbox/mapbox-gl-draw/src/modes/draw_line_string.js","../node_modules/@mapbox/mapbox-gl-draw/src/modes/index.js","../src/components/Draw/index.js"],"sourcesContent":["module.exports = [\n  {\n    'id': 'gl-draw-polygon-fill-inactive',\n    'type': 'fill',\n    'filter': ['all',\n      ['==', 'active', 'false'],\n      ['==', '$type', 'Polygon'],\n      ['!=', 'mode', 'static']\n    ],\n    'paint': {\n      'fill-color': '#3bb2d0',\n      'fill-outline-color': '#3bb2d0',\n      'fill-opacity': 0.1\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-fill-active',\n    'type': 'fill',\n    'filter': ['all', ['==', 'active', 'true'], ['==', '$type', 'Polygon']],\n    'paint': {\n      'fill-color': '#fbb03b',\n      'fill-outline-color': '#fbb03b',\n      'fill-opacity': 0.1\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-midpoint',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'midpoint']],\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-stroke-inactive',\n    'type': 'line',\n    'filter': ['all',\n      ['==', 'active', 'false'],\n      ['==', '$type', 'Polygon'],\n      ['!=', 'mode', 'static']\n    ],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round'\n    },\n    'paint': {\n      'line-color': '#3bb2d0',\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-stroke-active',\n    'type': 'line',\n    'filter': ['all', ['==', 'active', 'true'], ['==', '$type', 'Polygon']],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round'\n    },\n    'paint': {\n      'line-color': '#fbb03b',\n      'line-dasharray': [0.2, 2],\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-line-inactive',\n    'type': 'line',\n    'filter': ['all',\n      ['==', 'active', 'false'],\n      ['==', '$type', 'LineString'],\n      ['!=', 'mode', 'static']\n    ],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round'\n    },\n    'paint': {\n      'line-color': '#3bb2d0',\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-line-active',\n    'type': 'line',\n    'filter': ['all',\n      ['==', '$type', 'LineString'],\n      ['==', 'active', 'true']\n    ],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round'\n    },\n    'paint': {\n      'line-color': '#fbb03b',\n      'line-dasharray': [0.2, 2],\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-and-line-vertex-stroke-inactive',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', 'meta', 'vertex'],\n      ['==', '$type', 'Point'],\n      ['!=', 'mode', 'static']\n    ],\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-and-line-vertex-inactive',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', 'meta', 'vertex'],\n      ['==', '$type', 'Point'],\n      ['!=', 'mode', 'static']\n    ],\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-point-point-stroke-inactive',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', 'active', 'false'],\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'feature'],\n      ['!=', 'mode', 'static']\n    ],\n    'paint': {\n      'circle-radius': 5,\n      'circle-opacity': 1,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-point-inactive',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', 'active', 'false'],\n      ['==', '$type', 'Point'],\n      ['==', 'meta', 'feature'],\n      ['!=', 'mode', 'static']\n    ],\n    'paint': {\n      'circle-radius': 3,\n      'circle-color': '#3bb2d0'\n    }\n  },\n  {\n    'id': 'gl-draw-point-stroke-active',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', '$type', 'Point'],\n      ['==', 'active', 'true'],\n      ['!=', 'meta', 'midpoint']\n    ],\n    'paint': {\n      'circle-radius': 7,\n      'circle-color': '#fff'\n    }\n  },\n  {\n    'id': 'gl-draw-point-active',\n    'type': 'circle',\n    'filter': ['all',\n      ['==', '$type', 'Point'],\n      ['!=', 'meta', 'midpoint'],\n      ['==', 'active', 'true']],\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#fbb03b'\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-fill-static',\n    'type': 'fill',\n    'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Polygon']],\n    'paint': {\n      'fill-color': '#404040',\n      'fill-outline-color': '#404040',\n      'fill-opacity': 0.1\n    }\n  },\n  {\n    'id': 'gl-draw-polygon-stroke-static',\n    'type': 'line',\n    'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Polygon']],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round'\n    },\n    'paint': {\n      'line-color': '#404040',\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-line-static',\n    'type': 'line',\n    'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'LineString']],\n    'layout': {\n      'line-cap': 'round',\n      'line-join': 'round'\n    },\n    'paint': {\n      'line-color': '#404040',\n      'line-width': 2\n    }\n  },\n  {\n    'id': 'gl-draw-point-static',\n    'type': 'circle',\n    'filter': ['all', ['==', 'mode', 'static'], ['==', '$type', 'Point']],\n    'paint': {\n      'circle-radius': 5,\n      'circle-color': '#404040'\n    }\n  }\n];\n","module.exports = {\n  classes: {\n    CONTROL_BASE: 'mapboxgl-ctrl',\n    CONTROL_PREFIX: 'mapboxgl-ctrl-',\n    CONTROL_BUTTON: 'mapbox-gl-draw_ctrl-draw-btn',\n    CONTROL_BUTTON_LINE: 'mapbox-gl-draw_line',\n    CONTROL_BUTTON_POLYGON: 'mapbox-gl-draw_polygon',\n    CONTROL_BUTTON_POINT: 'mapbox-gl-draw_point',\n    CONTROL_BUTTON_TRASH: 'mapbox-gl-draw_trash',\n    CONTROL_BUTTON_COMBINE_FEATURES: 'mapbox-gl-draw_combine',\n    CONTROL_BUTTON_UNCOMBINE_FEATURES: 'mapbox-gl-draw_uncombine',\n    CONTROL_GROUP: 'mapboxgl-ctrl-group',\n    ATTRIBUTION: 'mapboxgl-ctrl-attrib',\n    ACTIVE_BUTTON: 'active',\n    BOX_SELECT: 'mapbox-gl-draw_boxselect'\n  },\n  sources: {\n    HOT: 'mapbox-gl-draw-hot',\n    COLD: 'mapbox-gl-draw-cold'\n  },\n  cursors: {\n    ADD: 'add',\n    MOVE: 'move',\n    DRAG: 'drag',\n    POINTER: 'pointer',\n    NONE: 'none'\n  },\n  types: {\n    POLYGON: 'polygon',\n    LINE: 'line_string',\n    POINT: 'point'\n  },\n  geojsonTypes: {\n    FEATURE: 'Feature',\n    POLYGON: 'Polygon',\n    LINE_STRING: 'LineString',\n    POINT: 'Point',\n    FEATURE_COLLECTION: 'FeatureCollection',\n    MULTI_PREFIX: 'Multi',\n    MULTI_POINT: 'MultiPoint',\n    MULTI_LINE_STRING: 'MultiLineString',\n    MULTI_POLYGON: 'MultiPolygon'\n  },\n  modes: {\n    DRAW_LINE_STRING: 'draw_line_string',\n    DRAW_POLYGON: 'draw_polygon',\n    DRAW_POINT: 'draw_point',\n    SIMPLE_SELECT: 'simple_select',\n    DIRECT_SELECT: 'direct_select',\n    STATIC: 'static'\n  },\n  events: {\n    CREATE: 'draw.create',\n    DELETE: 'draw.delete',\n    UPDATE: 'draw.update',\n    SELECTION_CHANGE: 'draw.selectionchange',\n    MODE_CHANGE: 'draw.modechange',\n    ACTIONABLE: 'draw.actionable',\n    RENDER: 'draw.render',\n    COMBINE_FEATURES: 'draw.combine',\n    UNCOMBINE_FEATURES: 'draw.uncombine'\n  },\n  updateActions: {\n    MOVE: 'move',\n    CHANGE_COORDINATES: 'change_coordinates'\n  },\n  meta: {\n    FEATURE: 'feature',\n    MIDPOINT: 'midpoint',\n    VERTEX: 'vertex'\n  },\n  activeStates: {\n    ACTIVE: 'true',\n    INACTIVE: 'false'\n  },\n  interactions: [\n    'scrollZoom',\n    'boxZoom',\n    'dragRotate',\n    'dragPan',\n    'keyboard',\n    'doubleClickZoom',\n    'touchZoomRotate'\n  ],\n  LAT_MIN: -90,\n  LAT_RENDERED_MIN: -85,\n  LAT_MAX: 90,\n  LAT_RENDERED_MAX: 85,\n  LNG_MIN: -270,\n  LNG_MAX: 270\n};\n","const Constants = require('../constants');\n\nmodule.exports = {\n  isOfMetaType: function(type) {\n    return function(e) {\n      const featureTarget = e.featureTarget;\n      if (!featureTarget) return false;\n      if (!featureTarget.properties) return false;\n      return featureTarget.properties.meta === type;\n    };\n  },\n  isShiftMousedown: function(e) {\n    if (!e.originalEvent) return false;\n    if (!e.originalEvent.shiftKey) return false;\n    return e.originalEvent.button === 0;\n  },\n  isActiveFeature: function(e) {\n    if (!e.featureTarget) return false;\n    if (!e.featureTarget.properties) return false;\n    return e.featureTarget.properties.active === Constants.activeStates.ACTIVE &&\n      e.featureTarget.properties.meta === Constants.meta.FEATURE;\n  },\n  isInactiveFeature: function(e) {\n    if (!e.featureTarget) return false;\n    if (!e.featureTarget.properties) return false;\n    return e.featureTarget.properties.active === Constants.activeStates.INACTIVE &&\n      e.featureTarget.properties.meta === Constants.meta.FEATURE;\n  },\n  noTarget: function(e) {\n    return e.featureTarget === undefined;\n  },\n  isFeature: function(e) {\n    if (!e.featureTarget) return false;\n    if (!e.featureTarget.properties) return false;\n    return e.featureTarget.properties.meta === Constants.meta.FEATURE;\n  },\n  isVertex: function(e) {\n    const featureTarget = e.featureTarget;\n    if (!featureTarget) return false;\n    if (!featureTarget.properties) return false;\n    return featureTarget.properties.meta === Constants.meta.VERTEX;\n  },\n  isShiftDown: function(e) {\n    if (!e.originalEvent) return false;\n    return e.originalEvent.shiftKey === true;\n  },\n  isEscapeKey: function(e) {\n    return e.keyCode === 27;\n  },\n  isEnterKey: function(e) {\n    return e.keyCode === 13;\n  },\n  true: function() {\n    return true;\n  }\n};\n","'use strict';\n\nmodule.exports = Point;\n\n/**\n * A standalone point geometry with useful accessor, comparison, and\n * modification methods.\n *\n * @class Point\n * @param {Number} x the x-coordinate. this could be longitude or screen\n * pixels, or any other sort of unit.\n * @param {Number} y the y-coordinate. this could be latitude or screen\n * pixels, or any other sort of unit.\n * @example\n * var point = new Point(-77, 38);\n */\nfunction Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n\n    /**\n     * Clone this point, returning a new point that can be modified\n     * without affecting the old one.\n     * @return {Point} the clone\n     */\n    clone: function() { return new Point(this.x, this.y); },\n\n    /**\n     * Add this point's x & y coordinates to another point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    add:     function(p) { return this.clone()._add(p); },\n\n    /**\n     * Subtract this point's x & y coordinates to from point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    sub:     function(p) { return this.clone()._sub(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    multByPoint:    function(p) { return this.clone()._multByPoint(p); },\n\n    /**\n     * Divide this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    divByPoint:     function(p) { return this.clone()._divByPoint(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {Point} k factor\n     * @return {Point} output point\n     */\n    mult:    function(k) { return this.clone()._mult(k); },\n\n    /**\n     * Divide this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {Point} k factor\n     * @return {Point} output point\n     */\n    div:     function(k) { return this.clone()._div(k); },\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * @param {Number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate:  function(a) { return this.clone()._rotate(a); },\n\n    /**\n     * Rotate this point around p point by an angle a,\n     * given in radians\n     * @param {Number} a angle to rotate around, in radians\n     * @param {Point} p Point to rotate around\n     * @return {Point} output point\n     */\n    rotateAround:  function(a,p) { return this.clone()._rotateAround(a,p); },\n\n    /**\n     * Multiply this point by a 4x1 transformation matrix\n     * @param {Array<Number>} m transformation matrix\n     * @return {Point} output point\n     */\n    matMult: function(m) { return this.clone()._matMult(m); },\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit:    function() { return this.clone()._unit(); },\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp:    function() { return this.clone()._perp(); },\n\n    /**\n     * Return a version of this point with the x & y coordinates\n     * rounded to integers.\n     * @return {Point} rounded point\n     */\n    round:   function() { return this.clone()._round(); },\n\n    /**\n     * Return the magitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {Number} magnitude\n     */\n    mag: function() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    /**\n     * Judge whether this point is equal to another point, returning\n     * true or false.\n     * @param {Point} other the other point\n     * @return {boolean} whether the points are equal\n     */\n    equals: function(other) {\n        return this.x === other.x &&\n               this.y === other.y;\n    },\n\n    /**\n     * Calculate the distance from this point to another point\n     * @param {Point} p the other point\n     * @return {Number} distance\n     */\n    dist: function(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    /**\n     * Calculate the distance from this point to another point,\n     * without the square root step. Useful if you're comparing\n     * relative distances.\n     * @param {Point} p the other point\n     * @return {Number} distance\n     */\n    distSqr: function(p) {\n        var dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    /**\n     * Get the angle from the 0, 0 coordinate to this point, in radians\n     * coordinates.\n     * @return {Number} angle\n     */\n    angle: function() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    /**\n     * Get the angle from this point to another point, in radians\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleTo: function(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleWith: function(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    /*\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * @param {Number} x the x-coordinate\n     * @param {Number} y the y-coordinate\n     * @return {Number} the angle in radians\n     */\n    angleWithSep: function(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    _matMult: function(m) {\n        var x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _add: function(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    _sub: function(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    _mult: function(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    _div: function(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    _multByPoint: function(p) {\n        this.x *= p.x;\n        this.y *= p.y;\n        return this;\n    },\n\n    _divByPoint: function(p) {\n        this.x /= p.x;\n        this.y /= p.y;\n        return this;\n    },\n\n    _unit: function() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp: function() {\n        var y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    _rotate: function(angle) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _rotateAround: function(angle, p) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n            y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round: function() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n};\n\n/**\n * Construct a point from an array if necessary, otherwise if the input\n * is already a Point, or an unknown type, return it unchanged\n * @param {Array<Number>|Point|*} a any kind of input value\n * @return {Point} constructed point, or passed-through value.\n * @example\n * // this\n * var point = Point.convert([0, 1]);\n * // is equivalent to\n * var point = new Point(0, 1);\n */\nPoint.convert = function (a) {\n    if (a instanceof Point) {\n        return a;\n    }\n    if (Array.isArray(a)) {\n        return new Point(a[0], a[1]);\n    }\n    return a;\n};\n","const Point = require('@mapbox/point-geometry');\n\n/**\n * Returns a Point representing a mouse event's position\n * relative to a containing element.\n *\n * @param {MouseEvent} mouseEvent\n * @param {Node} container\n * @returns {Point}\n */\nfunction mouseEventPoint(mouseEvent, container) {\n  const rect = container.getBoundingClientRect();\n  return new Point(\n    mouseEvent.clientX - rect.left - (container.clientLeft || 0),\n    mouseEvent.clientY - rect.top - (container.clientTop || 0)\n  );\n}\n\nmodule.exports = mouseEventPoint;\n","const Constants = require('../constants');\n\n/**\n * Returns GeoJSON for a Point representing the\n * vertex of another feature.\n *\n * @param {string} parentId\n * @param {Array<number>} coordinates\n * @param {string} path - Dot-separated numbers indicating exactly\n *   where the point exists within its parent feature's coordinates.\n * @param {boolean} selected\n * @return {GeoJSON} Point\n */\nmodule.exports = function(parentId, coordinates, path, selected) {\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: Constants.meta.VERTEX,\n      parent: parentId,\n      coord_path: path,\n      active: (selected) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: coordinates\n    }\n  };\n};\n","const Constants = require('../constants');\n\nmodule.exports = function(parent, startVertex, endVertex, map) {\n  const startCoord = startVertex.geometry.coordinates;\n  const endCoord = endVertex.geometry.coordinates;\n\n  // If a coordinate exceeds the projection, we can't calculate a midpoint,\n  // so run away\n  if (startCoord[1] > Constants.LAT_RENDERED_MAX ||\n    startCoord[1] < Constants.LAT_RENDERED_MIN ||\n    endCoord[1] > Constants.LAT_RENDERED_MAX ||\n    endCoord[1] < Constants.LAT_RENDERED_MIN) {\n    return null;\n  }\n\n  const ptA = map.project([ startCoord[0], startCoord[1] ]);\n  const ptB = map.project([ endCoord[0], endCoord[1] ]);\n  const mid = map.unproject([ (ptA.x + ptB.x) / 2, (ptA.y + ptB.y) / 2 ]);\n\n  return {\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      meta: Constants.meta.MIDPOINT,\n      parent: parent,\n      lng: mid.lng,\n      lat: mid.lat,\n      coord_path: endVertex.properties.coord_path\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: [mid.lng, mid.lat]\n    }\n  };\n};\n","const createVertex = require('./create_vertex');\nconst createMidpoint = require('./create_midpoint');\nconst Constants = require('../constants');\n\nfunction createSupplementaryPoints(geojson, options = {}, basePath = null) {\n  const { type, coordinates } = geojson.geometry;\n  const featureId = geojson.properties && geojson.properties.id;\n\n  let supplementaryPoints = [];\n\n  if (type === Constants.geojsonTypes.POINT) {\n    // For points, just create a vertex\n    supplementaryPoints.push(createVertex(featureId, coordinates, basePath, isSelectedPath(basePath)));\n  } else if (type === Constants.geojsonTypes.POLYGON) {\n    // Cycle through a Polygon's rings and\n    // process each line\n    coordinates.forEach((line, lineIndex) => {\n      processLine(line, (basePath !== null) ? `${basePath}.${lineIndex}` : String(lineIndex));\n    });\n  } else if (type === Constants.geojsonTypes.LINE_STRING) {\n    processLine(coordinates, basePath);\n  } else if (type.indexOf(Constants.geojsonTypes.MULTI_PREFIX) === 0) {\n    processMultiGeometry();\n  }\n\n  function processLine(line, lineBasePath) {\n    let firstPointString = '';\n    let lastVertex = null;\n    line.forEach((point, pointIndex) => {\n      const pointPath = (lineBasePath !== undefined && lineBasePath !== null) ? `${lineBasePath}.${pointIndex}` : String(pointIndex);\n      const vertex = createVertex(featureId, point, pointPath, isSelectedPath(pointPath));\n\n      // If we're creating midpoints, check if there was a\n      // vertex before this one. If so, add a midpoint\n      // between that vertex and this one.\n      if (options.midpoints && lastVertex) {\n        const midpoint = createMidpoint(featureId, lastVertex, vertex, options.map);\n        if (midpoint) {\n          supplementaryPoints.push(midpoint);\n        }\n      }\n      lastVertex = vertex;\n\n      // A Polygon line's last point is the same as the first point. If we're on the last\n      // point, we want to draw a midpoint before it but not another vertex on it\n      // (since we already a vertex there, from the first point).\n      const stringifiedPoint = JSON.stringify(point);\n      if (firstPointString !== stringifiedPoint) {\n        supplementaryPoints.push(vertex);\n      }\n      if (pointIndex === 0) {\n        firstPointString = stringifiedPoint;\n      }\n    });\n  }\n\n  function isSelectedPath(path) {\n    if (!options.selectedPaths) return false;\n    return options.selectedPaths.indexOf(path) !== -1;\n  }\n\n  // Split a multi-geometry into constituent\n  // geometries, and accumulate the supplementary points\n  // for each of those constituents\n  function processMultiGeometry() {\n    const subType = type.replace(Constants.geojsonTypes.MULTI_PREFIX, '');\n    coordinates.forEach((subCoordinates, index) => {\n      const subFeature = {\n        type: Constants.geojsonTypes.FEATURE,\n        properties: geojson.properties,\n        geometry: {\n          type: subType,\n          coordinates: subCoordinates\n        }\n      };\n      supplementaryPoints = supplementaryPoints.concat(createSupplementaryPoints(subFeature, options, index));\n    });\n  }\n\n  return supplementaryPoints;\n}\n\nmodule.exports = createSupplementaryPoints;\n","function StringSet(items) {\n  this._items = {};\n  this._nums = {};\n  this._length = items ? items.length : 0;\n  if (!items) return;\n  for (let i = 0, l = items.length; i < l; i++) {\n    this.add(items[i]);\n    if (items[i] === undefined) continue;\n    if (typeof items[i] === 'string') this._items[items[i]] = i;\n    else this._nums[items[i]] = i;\n\n  }\n}\n\nStringSet.prototype.add = function(x) {\n  if (this.has(x)) return this;\n  this._length++;\n  if (typeof x === 'string') this._items[x] = this._length;\n  else this._nums[x] = this._length;\n  return this;\n};\n\nStringSet.prototype.delete = function(x) {\n  if (this.has(x) === false) return this;\n  this._length--;\n  delete this._items[x];\n  delete this._nums[x];\n  return this;\n};\n\nStringSet.prototype.has = function(x) {\n  if (typeof x !== 'string' && typeof x !== 'number') return false;\n  return this._items[x] !== undefined || this._nums[x] !== undefined;\n};\n\nStringSet.prototype.values = function() {\n  const values = [];\n  Object.keys(this._items).forEach(k => {\n    values.push({ k: k, v: this._items[k] });\n  });\n  Object.keys(this._nums).forEach(k => {\n    values.push({ k: JSON.parse(k), v: this._nums[k] });\n  });\n\n  return values.sort((a, b) => a.v - b.v).map(a => a.k);\n};\n\nStringSet.prototype.clear = function() {\n  this._length = 0;\n  this._items = {};\n  this._nums = {};\n  return this;\n};\n\nmodule.exports = StringSet;\n","module.exports = {\n  enable(ctx) {\n    setTimeout(() => {\n      // First check we've got a map and some context.\n      if (!ctx.map || !ctx.map.doubleClickZoom || !ctx._ctx || !ctx._ctx.store || !ctx._ctx.store.getInitialConfigValue) return;\n      // Now check initial state wasn't false (we leave it disabled if so)\n      if (!ctx._ctx.store.getInitialConfigValue('doubleClickZoom')) return;\n      ctx.map.doubleClickZoom.enable();\n    }, 0);\n  },\n  disable(ctx) {\n    setTimeout(() => {\n      if (!ctx.map || !ctx.map.doubleClickZoom) return;\n      // Always disable here, as it's necessary in some cases.\n      ctx.map.doubleClickZoom.disable();\n    }, 0);\n  }\n};\n","module.exports = normalize;\n\nvar types = {\n    Point: 'geometry',\n    MultiPoint: 'geometry',\n    LineString: 'geometry',\n    MultiLineString: 'geometry',\n    Polygon: 'geometry',\n    MultiPolygon: 'geometry',\n    GeometryCollection: 'geometry',\n    Feature: 'feature',\n    FeatureCollection: 'featurecollection'\n};\n\n/**\n * Normalize a GeoJSON feature into a FeatureCollection.\n *\n * @param {object} gj geojson data\n * @returns {object} normalized geojson data\n */\nfunction normalize(gj) {\n    if (!gj || !gj.type) return null;\n    var type = types[gj.type];\n    if (!type) return null;\n\n    if (type === 'geometry') {\n        return {\n            type: 'FeatureCollection',\n            features: [{\n                type: 'Feature',\n                properties: {},\n                geometry: gj\n            }]\n        };\n    } else if (type === 'feature') {\n        return {\n            type: 'FeatureCollection',\n            features: [gj]\n        };\n    } else if (type === 'featurecollection') {\n        return gj;\n    }\n}\n","module.exports=function e(t){switch(t&&t.type||null){case\"FeatureCollection\":return t.features=t.features.reduce(function(t,r){return t.concat(e(r))},[]),t;case\"Feature\":return t.geometry?e(t.geometry).map(function(e){var r={type:\"Feature\",properties:JSON.parse(JSON.stringify(t.properties)),geometry:e};return void 0!==t.id&&(r.id=t.id),r}):t;case\"MultiPoint\":return t.coordinates.map(function(e){return{type:\"Point\",coordinates:e}});case\"MultiPolygon\":return t.coordinates.map(function(e){return{type:\"Polygon\",coordinates:e}});case\"MultiLineString\":return t.coordinates.map(function(e){return{type:\"LineString\",coordinates:e}});case\"GeometryCollection\":return t.geometries.map(e).reduce(function(e,t){return e.concat(t)},[]);case\"Point\":case\"Polygon\":case\"LineString\":return[t]}};\n//# sourceMappingURL=index.js.map\n","module.exports = function flatten(list) {\n    return _flatten(list);\n\n    function _flatten(list) {\n        if (Array.isArray(list) && list.length &&\n            typeof list[0] === 'number') {\n            return [list];\n        }\n        return list.reduce(function (acc, item) {\n            if (Array.isArray(item) && Array.isArray(item[0])) {\n                return acc.concat(_flatten(item));\n            } else {\n                acc.push(item);\n                return acc;\n            }\n        }, []);\n    }\n};\n","var geojsonNormalize = require('@mapbox/geojson-normalize'),\n    geojsonFlatten = require('geojson-flatten'),\n    flatten = require('./flatten');\n\nmodule.exports = function(_) {\n    if (!_) return [];\n    var normalized = geojsonFlatten(geojsonNormalize(_)),\n        coordinates = [];\n    normalized.features.forEach(function(feature) {\n        if (!feature.geometry) return;\n        coordinates = coordinates.concat(flatten(feature.geometry.coordinates));\n    });\n    return coordinates;\n};\n","var traverse = module.exports = function (obj) {\n    return new Traverse(obj);\n};\n\nfunction Traverse (obj) {\n    this.value = obj;\n}\n\nTraverse.prototype.get = function (ps) {\n    var node = this.value;\n    for (var i = 0; i < ps.length; i ++) {\n        var key = ps[i];\n        if (!node || !hasOwnProperty.call(node, key)) {\n            node = undefined;\n            break;\n        }\n        node = node[key];\n    }\n    return node;\n};\n\nTraverse.prototype.has = function (ps) {\n    var node = this.value;\n    for (var i = 0; i < ps.length; i ++) {\n        var key = ps[i];\n        if (!node || !hasOwnProperty.call(node, key)) {\n            return false;\n        }\n        node = node[key];\n    }\n    return true;\n};\n\nTraverse.prototype.set = function (ps, value) {\n    var node = this.value;\n    for (var i = 0; i < ps.length - 1; i ++) {\n        var key = ps[i];\n        if (!hasOwnProperty.call(node, key)) node[key] = {};\n        node = node[key];\n    }\n    node[ps[i]] = value;\n    return value;\n};\n\nTraverse.prototype.map = function (cb) {\n    return walk(this.value, cb, true);\n};\n\nTraverse.prototype.forEach = function (cb) {\n    this.value = walk(this.value, cb, false);\n    return this.value;\n};\n\nTraverse.prototype.reduce = function (cb, init) {\n    var skip = arguments.length === 1;\n    var acc = skip ? this.value : init;\n    this.forEach(function (x) {\n        if (!this.isRoot || !skip) {\n            acc = cb.call(this, acc, x);\n        }\n    });\n    return acc;\n};\n\nTraverse.prototype.paths = function () {\n    var acc = [];\n    this.forEach(function (x) {\n        acc.push(this.path); \n    });\n    return acc;\n};\n\nTraverse.prototype.nodes = function () {\n    var acc = [];\n    this.forEach(function (x) {\n        acc.push(this.node);\n    });\n    return acc;\n};\n\nTraverse.prototype.clone = function () {\n    var parents = [], nodes = [];\n    \n    return (function clone (src) {\n        for (var i = 0; i < parents.length; i++) {\n            if (parents[i] === src) {\n                return nodes[i];\n            }\n        }\n        \n        if (typeof src === 'object' && src !== null) {\n            var dst = copy(src);\n            \n            parents.push(src);\n            nodes.push(dst);\n            \n            forEach(objectKeys(src), function (key) {\n                dst[key] = clone(src[key]);\n            });\n            \n            parents.pop();\n            nodes.pop();\n            return dst;\n        }\n        else {\n            return src;\n        }\n    })(this.value);\n};\n\nfunction walk (root, cb, immutable) {\n    var path = [];\n    var parents = [];\n    var alive = true;\n    \n    return (function walker (node_) {\n        var node = immutable ? copy(node_) : node_;\n        var modifiers = {};\n        \n        var keepGoing = true;\n        \n        var state = {\n            node : node,\n            node_ : node_,\n            path : [].concat(path),\n            parent : parents[parents.length - 1],\n            parents : parents,\n            key : path.slice(-1)[0],\n            isRoot : path.length === 0,\n            level : path.length,\n            circular : null,\n            update : function (x, stopHere) {\n                if (!state.isRoot) {\n                    state.parent.node[state.key] = x;\n                }\n                state.node = x;\n                if (stopHere) keepGoing = false;\n            },\n            'delete' : function (stopHere) {\n                delete state.parent.node[state.key];\n                if (stopHere) keepGoing = false;\n            },\n            remove : function (stopHere) {\n                if (isArray(state.parent.node)) {\n                    state.parent.node.splice(state.key, 1);\n                }\n                else {\n                    delete state.parent.node[state.key];\n                }\n                if (stopHere) keepGoing = false;\n            },\n            keys : null,\n            before : function (f) { modifiers.before = f },\n            after : function (f) { modifiers.after = f },\n            pre : function (f) { modifiers.pre = f },\n            post : function (f) { modifiers.post = f },\n            stop : function () { alive = false },\n            block : function () { keepGoing = false }\n        };\n        \n        if (!alive) return state;\n        \n        function updateState() {\n            if (typeof state.node === 'object' && state.node !== null) {\n                if (!state.keys || state.node_ !== state.node) {\n                    state.keys = objectKeys(state.node)\n                }\n                \n                state.isLeaf = state.keys.length == 0;\n                \n                for (var i = 0; i < parents.length; i++) {\n                    if (parents[i].node_ === node_) {\n                        state.circular = parents[i];\n                        break;\n                    }\n                }\n            }\n            else {\n                state.isLeaf = true;\n                state.keys = null;\n            }\n            \n            state.notLeaf = !state.isLeaf;\n            state.notRoot = !state.isRoot;\n        }\n        \n        updateState();\n        \n        // use return values to update if defined\n        var ret = cb.call(state, state.node);\n        if (ret !== undefined && state.update) state.update(ret);\n        \n        if (modifiers.before) modifiers.before.call(state, state.node);\n        \n        if (!keepGoing) return state;\n        \n        if (typeof state.node == 'object'\n        && state.node !== null && !state.circular) {\n            parents.push(state);\n            \n            updateState();\n            \n            forEach(state.keys, function (key, i) {\n                path.push(key);\n                \n                if (modifiers.pre) modifiers.pre.call(state, state.node[key], key);\n                \n                var child = walker(state.node[key]);\n                if (immutable && hasOwnProperty.call(state.node, key)) {\n                    state.node[key] = child.node;\n                }\n                \n                child.isLast = i == state.keys.length - 1;\n                child.isFirst = i == 0;\n                \n                if (modifiers.post) modifiers.post.call(state, child);\n                \n                path.pop();\n            });\n            parents.pop();\n        }\n        \n        if (modifiers.after) modifiers.after.call(state, state.node);\n        \n        return state;\n    })(root).node;\n}\n\nfunction copy (src) {\n    if (typeof src === 'object' && src !== null) {\n        var dst;\n        \n        if (isArray(src)) {\n            dst = [];\n        }\n        else if (isDate(src)) {\n            dst = new Date(src.getTime ? src.getTime() : src);\n        }\n        else if (isRegExp(src)) {\n            dst = new RegExp(src);\n        }\n        else if (isError(src)) {\n            dst = { message: src.message };\n        }\n        else if (isBoolean(src)) {\n            dst = new Boolean(src);\n        }\n        else if (isNumber(src)) {\n            dst = new Number(src);\n        }\n        else if (isString(src)) {\n            dst = new String(src);\n        }\n        else if (Object.create && Object.getPrototypeOf) {\n            dst = Object.create(Object.getPrototypeOf(src));\n        }\n        else if (src.constructor === Object) {\n            dst = {};\n        }\n        else {\n            var proto =\n                (src.constructor && src.constructor.prototype)\n                || src.__proto__\n                || {}\n            ;\n            var T = function () {};\n            T.prototype = proto;\n            dst = new T;\n        }\n        \n        forEach(objectKeys(src), function (key) {\n            dst[key] = src[key];\n        });\n        return dst;\n    }\n    else return src;\n}\n\nvar objectKeys = Object.keys || function keys (obj) {\n    var res = [];\n    for (var key in obj) res.push(key)\n    return res;\n};\n\nfunction toS (obj) { return Object.prototype.toString.call(obj) }\nfunction isDate (obj) { return toS(obj) === '[object Date]' }\nfunction isRegExp (obj) { return toS(obj) === '[object RegExp]' }\nfunction isError (obj) { return toS(obj) === '[object Error]' }\nfunction isBoolean (obj) { return toS(obj) === '[object Boolean]' }\nfunction isNumber (obj) { return toS(obj) === '[object Number]' }\nfunction isString (obj) { return toS(obj) === '[object String]' }\n\nvar isArray = Array.isArray || function isArray (xs) {\n    return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nvar forEach = function (xs, fn) {\n    if (xs.forEach) return xs.forEach(fn)\n    else for (var i = 0; i < xs.length; i++) {\n        fn(xs[i], i, xs);\n    }\n};\n\nforEach(objectKeys(Traverse.prototype), function (key) {\n    traverse[key] = function (obj) {\n        var args = [].slice.call(arguments, 1);\n        var t = new Traverse(obj);\n        return t[key].apply(t, args);\n    };\n});\n\nvar hasOwnProperty = Object.hasOwnProperty || function (obj, key) {\n    return key in obj;\n};\n","module.exports = Extent;\n\nfunction Extent(bbox) {\n    if (!(this instanceof Extent)) {\n        return new Extent(bbox);\n    }\n    this._bbox = bbox || [Infinity, Infinity, -Infinity, -Infinity];\n    this._valid = !!bbox;\n}\n\nExtent.prototype.include = function(ll) {\n    this._valid = true;\n    this._bbox[0] = Math.min(this._bbox[0], ll[0]);\n    this._bbox[1] = Math.min(this._bbox[1], ll[1]);\n    this._bbox[2] = Math.max(this._bbox[2], ll[0]);\n    this._bbox[3] = Math.max(this._bbox[3], ll[1]);\n    return this;\n};\n\nExtent.prototype.equals = function(_) {\n    var other;\n    if (_ instanceof Extent) { other = _.bbox(); } else { other = _; }\n    return this._bbox[0] == other[0] &&\n        this._bbox[1] == other[1] &&\n        this._bbox[2] == other[2] &&\n        this._bbox[3] == other[3];\n};\n\nExtent.prototype.center = function(_) {\n    if (!this._valid) return null;\n    return [\n        (this._bbox[0] + this._bbox[2]) / 2,\n        (this._bbox[1] + this._bbox[3]) / 2]\n};\n\nExtent.prototype.union = function(_) {\n    this._valid = true;\n    var other;\n    if (_ instanceof Extent) { other = _.bbox(); } else { other = _; }\n    this._bbox[0] = Math.min(this._bbox[0], other[0]);\n    this._bbox[1] = Math.min(this._bbox[1], other[1]);\n    this._bbox[2] = Math.max(this._bbox[2], other[2]);\n    this._bbox[3] = Math.max(this._bbox[3], other[3]);\n    return this;\n};\n\nExtent.prototype.bbox = function() {\n    if (!this._valid) return null;\n    return this._bbox;\n};\n\nExtent.prototype.contains = function(ll) {\n    if (!ll) return this._fastContains();\n    if (!this._valid) return null;\n    var lon = ll[0], lat = ll[1];\n    return this._bbox[0] <= lon &&\n        this._bbox[1] <= lat &&\n        this._bbox[2] >= lon &&\n        this._bbox[3] >= lat;\n};\n\nExtent.prototype.intersect = function(_) {\n    if (!this._valid) return null;\n\n    var other;\n    if (_ instanceof Extent) { other = _.bbox(); } else { other = _; }\n\n    return !(\n      this._bbox[0] > other[2] ||\n      this._bbox[2] < other[0] ||\n      this._bbox[3] < other[1] ||\n      this._bbox[1] > other[3]\n    );\n};\n\nExtent.prototype._fastContains = function() {\n    if (!this._valid) return new Function('return null;');\n    var body = 'return ' +\n        this._bbox[0] + '<= ll[0] &&' +\n        this._bbox[1] + '<= ll[1] &&' +\n        this._bbox[2] + '>= ll[0] &&' +\n        this._bbox[3] + '>= ll[1]';\n    return new Function('ll', body);\n};\n\nExtent.prototype.polygon = function() {\n    if (!this._valid) return null;\n    return {\n        type: 'Polygon',\n        coordinates: [\n            [\n                // W, S\n                [this._bbox[0], this._bbox[1]],\n                // E, S\n                [this._bbox[2], this._bbox[1]],\n                // E, N\n                [this._bbox[2], this._bbox[3]],\n                // W, N\n                [this._bbox[0], this._bbox[3]],\n                // W, S\n                [this._bbox[0], this._bbox[1]]\n            ]\n        ]\n    };\n};\n","var geojsonCoords = require('@mapbox/geojson-coords'),\n    traverse = require('traverse'),\n    extent = require('@mapbox/extent');\n\nvar geojsonTypesByDataAttributes = {\n    features: ['FeatureCollection'],\n    coordinates: ['Point', 'MultiPoint', 'LineString', 'MultiLineString', 'Polygon', 'MultiPolygon'],\n    geometry: ['Feature'],\n    geometries: ['GeometryCollection']\n}\n\nvar dataAttributes = Object.keys(geojsonTypesByDataAttributes);\n\nmodule.exports = function(_) {\n    return getExtent(_).bbox();\n};\n\nmodule.exports.polygon = function(_) {\n    return getExtent(_).polygon();\n};\n\nmodule.exports.bboxify = function(_) {\n    return traverse(_).map(function(value) {\n        if (!value) return ;\n\n        var isValid = dataAttributes.some(function(attribute){\n            if(value[attribute]) {\n                return geojsonTypesByDataAttributes[attribute].indexOf(value.type) !== -1;\n            }\n            return false;\n        });\n\n        if(isValid){\n            value.bbox = getExtent(value).bbox();\n            this.update(value);\n        }\n\n    });\n};\n\nfunction getExtent(_) {\n    var bbox = [Infinity, Infinity, -Infinity, -Infinity],\n        ext = extent(),\n        coords = geojsonCoords(_);\n    for (var i = 0; i < coords.length; i++) ext.include(coords[i]);\n    return ext;\n}\n","const extent = require('@mapbox/geojson-extent');\nconst Constants = require('../constants');\n\nconst {\n  LAT_MIN,\n  LAT_MAX,\n  LAT_RENDERED_MIN,\n  LAT_RENDERED_MAX,\n  LNG_MIN,\n  LNG_MAX\n} = Constants;\n\n// Ensure that we do not drag north-south far enough for\n// - any part of any feature to exceed the poles\n// - any feature to be completely lost in the space between the projection's\n//   edge and the poles, such that it couldn't be re-selected and moved back\nmodule.exports = function(geojsonFeatures, delta) {\n  // \"inner edge\" = a feature's latitude closest to the equator\n  let northInnerEdge = LAT_MIN;\n  let southInnerEdge = LAT_MAX;\n  // \"outer edge\" = a feature's latitude furthest from the equator\n  let northOuterEdge = LAT_MIN;\n  let southOuterEdge = LAT_MAX;\n\n  let westEdge = LNG_MAX;\n  let eastEdge = LNG_MIN;\n\n  geojsonFeatures.forEach(feature => {\n    const bounds = extent(feature);\n    const featureSouthEdge = bounds[1];\n    const featureNorthEdge = bounds[3];\n    const featureWestEdge = bounds[0];\n    const featureEastEdge = bounds[2];\n    if (featureSouthEdge > northInnerEdge) northInnerEdge = featureSouthEdge;\n    if (featureNorthEdge < southInnerEdge) southInnerEdge = featureNorthEdge;\n    if (featureNorthEdge > northOuterEdge) northOuterEdge = featureNorthEdge;\n    if (featureSouthEdge < southOuterEdge) southOuterEdge = featureSouthEdge;\n    if (featureWestEdge < westEdge) westEdge = featureWestEdge;\n    if (featureEastEdge > eastEdge) eastEdge = featureEastEdge;\n  });\n\n\n  // These changes are not mutually exclusive: we might hit the inner\n  // edge but also have hit the outer edge and therefore need\n  // another readjustment\n  const constrainedDelta = delta;\n  if (northInnerEdge + constrainedDelta.lat > LAT_RENDERED_MAX) {\n    constrainedDelta.lat = LAT_RENDERED_MAX - northInnerEdge;\n  }\n  if (northOuterEdge + constrainedDelta.lat > LAT_MAX) {\n    constrainedDelta.lat = LAT_MAX - northOuterEdge;\n  }\n  if (southInnerEdge + constrainedDelta.lat < LAT_RENDERED_MIN) {\n    constrainedDelta.lat = LAT_RENDERED_MIN - southInnerEdge;\n  }\n  if (southOuterEdge + constrainedDelta.lat < LAT_MIN) {\n    constrainedDelta.lat = LAT_MIN - southOuterEdge;\n  }\n  if (westEdge + constrainedDelta.lng <= LNG_MIN) {\n    constrainedDelta.lng += Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n  if (eastEdge + constrainedDelta.lng >= LNG_MAX) {\n    constrainedDelta.lng -= Math.ceil(Math.abs(constrainedDelta.lng) / 360) * 360;\n  }\n\n  return constrainedDelta;\n};\n","const constrainFeatureMovement = require('./constrain_feature_movement');\nconst Constants = require('../constants');\n\nmodule.exports = function(features, delta) {\n  const constrainedDelta = constrainFeatureMovement(features.map(feature => feature.toGeoJSON()), delta);\n\n  features.forEach(feature => {\n    const currentCoordinates = feature.getCoordinates();\n\n    const moveCoordinate = (coord) => {\n      const point = {\n        lng: coord[0] + constrainedDelta.lng,\n        lat: coord[1] + constrainedDelta.lat\n      };\n      return [point.lng, point.lat];\n    };\n    const moveRing = (ring) => ring.map(coord => moveCoordinate(coord));\n    const moveMultiPolygon = (multi) => multi.map(ring => moveRing(ring));\n\n    let nextCoordinates;\n    if (feature.type === Constants.geojsonTypes.POINT) {\n      nextCoordinates = moveCoordinate(currentCoordinates);\n    } else if (feature.type === Constants.geojsonTypes.LINE_STRING || feature.type === Constants.geojsonTypes.MULTI_POINT) {\n      nextCoordinates = currentCoordinates.map(moveCoordinate);\n    } else if (feature.type === Constants.geojsonTypes.POLYGON || feature.type === Constants.geojsonTypes.MULTI_LINE_STRING) {\n      nextCoordinates = currentCoordinates.map(moveRing);\n    } else if (feature.type === Constants.geojsonTypes.MULTI_POLYGON) {\n      nextCoordinates = currentCoordinates.map(moveMultiPolygon);\n    }\n\n    feature.incomingCoords(nextCoordinates);\n  });\n};\n","const CommonSelectors = require('../lib/common_selectors');\nconst mouseEventPoint = require('../lib/mouse_event_point');\nconst createSupplementaryPoints = require('../lib/create_supplementary_points');\nconst StringSet = require('../lib/string_set');\nconst doubleClickZoom = require('../lib/double_click_zoom');\nconst moveFeatures = require('../lib/move_features');\nconst Constants = require('../constants');\n\nconst SimpleSelect = {};\n\nSimpleSelect.onSetup = function(opts) {\n  // turn the opts into state.\n  const state = {\n    dragMoveLocation: null,\n    boxSelectStartLocation: null,\n    boxSelectElement: undefined,\n    boxSelecting: false,\n    canBoxSelect: false,\n    dragMoveing: false,\n    canDragMove: false,\n    initiallySelectedFeatureIds: opts.featureIds || []\n  };\n\n  this.setSelected(state.initiallySelectedFeatureIds.filter(id => {\n    return this.getFeature(id) !== undefined;\n  }));\n  this.fireActionable();\n\n  this.setActionableState({\n    combineFeatures: true,\n    uncombineFeatures: true,\n    trash: true\n  });\n\n  return state;\n};\n\nSimpleSelect.fireUpdate = function() {\n  this.map.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.MOVE,\n    features: this.getSelected().map(f => f.toGeoJSON())\n  });\n};\n\nSimpleSelect.fireActionable = function() {\n  const selectedFeatures = this.getSelected();\n\n  const multiFeatures = selectedFeatures.filter(\n    feature => this.isInstanceOf('MultiFeature', feature)\n  );\n\n  let combineFeatures = false;\n\n  if (selectedFeatures.length > 1) {\n    combineFeatures = true;\n    const featureType = selectedFeatures[0].type.replace('Multi', '');\n    selectedFeatures.forEach(feature => {\n      if (feature.type.replace('Multi', '') !== featureType) {\n        combineFeatures = false;\n      }\n    });\n  }\n\n  const uncombineFeatures = multiFeatures.length > 0;\n  const trash = selectedFeatures.length > 0;\n\n  this.setActionableState({\n    combineFeatures, uncombineFeatures, trash\n  });\n};\n\nSimpleSelect.getUniqueIds = function(allFeatures) {\n  if (!allFeatures.length) return [];\n  const ids = allFeatures.map(s => s.properties.id)\n    .filter(id => id !== undefined)\n    .reduce((memo, id) => {\n      memo.add(id);\n      return memo;\n    }, new StringSet());\n\n  return ids.values();\n};\n\nSimpleSelect.stopExtendedInteractions = function(state) {\n  if (state.boxSelectElement) {\n    if (state.boxSelectElement.parentNode) state.boxSelectElement.parentNode.removeChild(state.boxSelectElement);\n    state.boxSelectElement = null;\n  }\n\n  this.map.dragPan.enable();\n\n  state.boxSelecting = false;\n  state.canBoxSelect = false;\n  state.dragMoving = false;\n  state.canDragMove = false;\n};\n\nSimpleSelect.onStop = function() {\n  doubleClickZoom.enable(this);\n};\n\nSimpleSelect.onMouseMove = function(state) {\n  // On mousemove that is not a drag, stop extended interactions.\n  // This is useful if you drag off the canvas, release the button,\n  // then move the mouse back over the canvas --- we don't allow the\n  // interaction to continue then, but we do let it continue if you held\n  // the mouse button that whole time\n  return this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.onMouseOut = function(state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) return this.fireUpdate();\n};\n\nSimpleSelect.onTap = SimpleSelect.onClick = function(state, e) {\n  // Click (with or without shift) on no feature\n  if (CommonSelectors.noTarget(e)) return this.clickAnywhere(state, e); // also tap\n  if (CommonSelectors.isOfMetaType(Constants.meta.VERTEX)(e)) return this.clickOnVertex(state, e); //tap\n  if (CommonSelectors.isFeature(e)) return this.clickOnFeature(state, e);\n};\n\nSimpleSelect.clickAnywhere = function (state) {\n  // Clear the re-render selection\n  const wasSelected = this.getSelectedIds();\n  if (wasSelected.length) {\n    this.clearSelectedFeatures();\n    wasSelected.forEach(id => this.doRender(id));\n  }\n  doubleClickZoom.enable(this);\n  this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.clickOnVertex = function(state, e) {\n  // Enter direct select mode\n  this.changeMode(Constants.modes.DIRECT_SELECT, {\n    featureId: e.featureTarget.properties.parent,\n    coordPath: e.featureTarget.properties.coord_path,\n    startPos: e.lngLat\n  });\n  this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n};\n\nSimpleSelect.startOnActiveFeature = function(state, e) {\n  // Stop any already-underway extended interactions\n  this.stopExtendedInteractions(state);\n\n  // Disable map.dragPan immediately so it can't start\n  this.map.dragPan.disable();\n\n  // Re-render it and enable drag move\n  this.doRender(e.featureTarget.properties.id);\n\n  // Set up the state for drag moving\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nSimpleSelect.clickOnFeature = function(state, e) {\n  // Stop everything\n  doubleClickZoom.disable(this);\n  this.stopExtendedInteractions(state);\n\n  const isShiftClick = CommonSelectors.isShiftDown(e);\n  const selectedFeatureIds = this.getSelectedIds();\n  const featureId = e.featureTarget.properties.id;\n  const isFeatureSelected = this.isSelected(featureId);\n\n  // Click (without shift) on any selected feature but a point\n  if (!isShiftClick && isFeatureSelected && this.getFeature(featureId).type !== Constants.geojsonTypes.POINT) {\n    // Enter direct select mode\n    return this.changeMode(Constants.modes.DIRECT_SELECT, {\n      featureId: featureId\n    });\n  }\n\n  // Shift-click on a selected feature\n  if (isFeatureSelected && isShiftClick) {\n    // Deselect it\n    this.deselect(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n    if (selectedFeatureIds.length === 1) {\n      doubleClickZoom.enable(this);\n    }\n  // Shift-click on an unselected feature\n  } else if (!isFeatureSelected && isShiftClick) {\n    // Add it to the selection\n    this.select(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  // Click (without shift) on an unselected feature\n  } else if (!isFeatureSelected && !isShiftClick) {\n    // Make it the only selected feature\n    selectedFeatureIds.forEach(id => this.doRender(id));\n    this.setSelected(featureId);\n    this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  }\n\n  // No matter what, re-render the clicked feature\n  this.doRender(featureId);\n};\n\nSimpleSelect.onMouseDown = function(state, e) {\n  if (CommonSelectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n  if (this.drawConfig.boxSelect && CommonSelectors.isShiftMousedown(e)) return this.startBoxSelect(state, e);\n};\n\nSimpleSelect.startBoxSelect = function(state, e) {\n  this.stopExtendedInteractions(state);\n  this.map.dragPan.disable();\n  // Enable box select\n  state.boxSelectStartLocation = mouseEventPoint(e.originalEvent, this.map.getContainer());\n  state.canBoxSelect = true;\n};\n\nSimpleSelect.onTouchStart = function(state, e) {\n  if (CommonSelectors.isActiveFeature(e)) return this.startOnActiveFeature(state, e);\n};\n\nSimpleSelect.onDrag = function(state, e) {\n  if (state.canDragMove) return this.dragMove(state, e);\n  if (this.drawConfig.boxSelect && state.canBoxSelect) return this.whileBoxSelect(state, e);\n};\n\nSimpleSelect.whileBoxSelect = function(state, e) {\n  state.boxSelecting = true;\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n\n  // Create the box node if it doesn't exist\n  if (!state.boxSelectElement) {\n    state.boxSelectElement = document.createElement('div');\n    state.boxSelectElement.classList.add(Constants.classes.BOX_SELECT);\n    this.map.getContainer().appendChild(state.boxSelectElement);\n  }\n\n  // Adjust the box node's width and xy position\n  const current = mouseEventPoint(e.originalEvent, this.map.getContainer());\n  const minX = Math.min(state.boxSelectStartLocation.x, current.x);\n  const maxX = Math.max(state.boxSelectStartLocation.x, current.x);\n  const minY = Math.min(state.boxSelectStartLocation.y, current.y);\n  const maxY = Math.max(state.boxSelectStartLocation.y, current.y);\n  const translateValue = `translate(${minX}px, ${minY}px)`;\n  state.boxSelectElement.style.transform = translateValue;\n  state.boxSelectElement.style.WebkitTransform = translateValue;\n  state.boxSelectElement.style.width = `${maxX - minX}px`;\n  state.boxSelectElement.style.height = `${maxY - minY}px`;\n};\n\nSimpleSelect.dragMove = function(state, e) {\n  // Dragging when drag move is enabled\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat\n  };\n\n  moveFeatures(this.getSelected(), delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nSimpleSelect.onMouseUp = function(state, e) {\n  // End any extended interactions\n  if (state.dragMoving) {\n    this.fireUpdate();\n  } else if (state.boxSelecting) {\n    const bbox = [\n      state.boxSelectStartLocation,\n      mouseEventPoint(e.originalEvent, this.map.getContainer())\n    ];\n    const featuresInBox = this.featuresAt(null, bbox, 'click');\n    const idsToSelect = this.getUniqueIds(featuresInBox)\n      .filter(id => !this.isSelected(id));\n\n    if (idsToSelect.length) {\n      this.select(idsToSelect);\n      idsToSelect.forEach(id => this.doRender(id));\n      this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n    }\n  }\n  this.stopExtendedInteractions(state);\n};\n\nSimpleSelect.toDisplayFeatures = function(state, geojson, display) {\n  geojson.properties.active = (this.isSelected(geojson.properties.id)) ?\n    Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  display(geojson);\n  this.fireActionable();\n  if (geojson.properties.active !== Constants.activeStates.ACTIVE ||\n    geojson.geometry.type === Constants.geojsonTypes.POINT) return;\n  createSupplementaryPoints(geojson).forEach(display);\n};\n\nSimpleSelect.onTrash = function() {\n  this.deleteFeature(this.getSelectedIds());\n  this.fireActionable();\n};\n\nSimpleSelect.onCombineFeatures = function() {\n  const selectedFeatures = this.getSelected();\n\n  if (selectedFeatures.length === 0 || selectedFeatures.length < 2) return;\n\n  const coordinates = [], featuresCombined = [];\n  const featureType = selectedFeatures[0].type.replace('Multi', '');\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (feature.type.replace('Multi', '') !== featureType) {\n      return;\n    }\n    if (feature.type.includes('Multi')) {\n      feature.getCoordinates().forEach((subcoords) => {\n        coordinates.push(subcoords);\n      });\n    } else {\n      coordinates.push(feature.getCoordinates());\n    }\n\n    featuresCombined.push(feature.toGeoJSON());\n  }\n\n  if (featuresCombined.length > 1) {\n    const multiFeature = this.newFeature({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: featuresCombined[0].properties,\n      geometry: {\n        type: `Multi${featureType}`,\n        coordinates: coordinates\n      }\n    });\n\n    this.addFeature(multiFeature);\n    this.deleteFeature(this.getSelectedIds(), { silent: true });\n    this.setSelected([multiFeature.id]);\n\n    this.map.fire(Constants.events.COMBINE_FEATURES, {\n      createdFeatures: [multiFeature.toGeoJSON()],\n      deletedFeatures: featuresCombined\n    });\n  }\n  this.fireActionable();\n};\n\nSimpleSelect.onUncombineFeatures = function() {\n  const selectedFeatures = this.getSelected();\n  if (selectedFeatures.length === 0) return;\n\n  const createdFeatures = [];\n  const featuresUncombined = [];\n\n  for (let i = 0; i < selectedFeatures.length; i++) {\n    const feature = selectedFeatures[i];\n\n    if (this.isInstanceOf('MultiFeature', feature)) {\n      feature.getFeatures().forEach((subFeature) => {\n        this.addFeature(subFeature);\n        subFeature.properties = feature.properties;\n        createdFeatures.push(subFeature.toGeoJSON());\n        this.select([subFeature.id]);\n      });\n      this.deleteFeature(feature.id, { silent: true });\n      featuresUncombined.push(feature.toGeoJSON());\n    }\n  }\n\n  if (createdFeatures.length > 1) {\n    this.map.fire(Constants.events.UNCOMBINE_FEATURES, {\n      createdFeatures: createdFeatures,\n      deletedFeatures: featuresUncombined\n    });\n  }\n  this.fireActionable();\n};\n\nmodule.exports = SimpleSelect;\n","const {noTarget, isOfMetaType, isInactiveFeature, isShiftDown} = require('../lib/common_selectors');\nconst createSupplementaryPoints = require('../lib/create_supplementary_points');\nconst constrainFeatureMovement = require('../lib/constrain_feature_movement');\nconst doubleClickZoom = require('../lib/double_click_zoom');\nconst Constants = require('../constants');\nconst CommonSelectors = require('../lib/common_selectors');\nconst moveFeatures = require('../lib/move_features');\n\nconst isVertex = isOfMetaType(Constants.meta.VERTEX);\nconst isMidpoint = isOfMetaType(Constants.meta.MIDPOINT);\n\nconst DirectSelect = {};\n\n// INTERNAL FUCNTIONS\n\nDirectSelect.fireUpdate = function() {\n  this.map.fire(Constants.events.UPDATE, {\n    action: Constants.updateActions.CHANGE_COORDINATES,\n    features: this.getSelected().map(f => f.toGeoJSON())\n  });\n};\n\nDirectSelect.fireActionable = function(state) {\n  this.setActionableState({\n    combineFeatures: false,\n    uncombineFeatures: false,\n    trash: state.selectedCoordPaths.length > 0\n  });\n};\n\nDirectSelect.startDragging = function(state, e) {\n  this.map.dragPan.disable();\n  state.canDragMove = true;\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.stopDragging = function(state) {\n  this.map.dragPan.enable();\n  state.dragMoving = false;\n  state.canDragMove = false;\n  state.dragMoveLocation = null;\n};\n\nDirectSelect.onVertex = function (state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  const selectedIndex = state.selectedCoordPaths.indexOf(about.coord_path);\n  if (!isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths = [about.coord_path];\n  } else if (isShiftDown(e) && selectedIndex === -1) {\n    state.selectedCoordPaths.push(about.coord_path);\n  }\n\n  const selectedCoordinates = this.pathsToCoordinates(state.featureId, state.selectedCoordPaths);\n  this.setSelectedCoordinates(selectedCoordinates);\n};\n\nDirectSelect.onMidpoint = function(state, e) {\n  this.startDragging(state, e);\n  const about = e.featureTarget.properties;\n  state.feature.addCoordinate(about.coord_path, about.lng, about.lat);\n  this.fireUpdate();\n  state.selectedCoordPaths = [about.coord_path];\n};\n\nDirectSelect.pathsToCoordinates = function(featureId, paths) {\n  return paths.map(coord_path => { return { feature_id: featureId, coord_path }; });\n};\n\nDirectSelect.onFeature = function(state, e) {\n  if (state.selectedCoordPaths.length === 0) this.startDragging(state, e);\n  else this.stopDragging(state);\n};\n\nDirectSelect.dragFeature = function(state, e, delta) {\n  moveFeatures(this.getSelected(), delta);\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.dragVertex = function(state, e, delta) {\n  const selectedCoords = state.selectedCoordPaths.map(coord_path => state.feature.getCoordinate(coord_path));\n  const selectedCoordPoints = selectedCoords.map(coords => ({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: coords\n    }\n  }));\n\n  const constrainedDelta = constrainFeatureMovement(selectedCoordPoints, delta);\n  for (let i = 0; i < selectedCoords.length; i++) {\n    const coord = selectedCoords[i];\n    state.feature.updateCoordinate(state.selectedCoordPaths[i], coord[0] + constrainedDelta.lng, coord[1] + constrainedDelta.lat);\n  }\n};\n\nDirectSelect.clickNoTarget = function () {\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDirectSelect.clickInactive = function () {\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDirectSelect.clickActiveFeature = function (state) {\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  state.feature.changed();\n};\n\n// EXTERNAL FUNCTIONS\n\nDirectSelect.onSetup = function(opts) {\n  const featureId = opts.featureId;\n  const feature = this.getFeature(featureId);\n\n  if (!feature) {\n    throw new Error('You must provide a featureId to enter direct_select mode');\n  }\n\n  if (feature.type === Constants.geojsonTypes.POINT) {\n    throw new TypeError('direct_select mode doesn\\'t handle point features');\n  }\n\n  const state = {\n    featureId,\n    feature,\n    dragMoveLocation: opts.startPos || null,\n    dragMoving: false,\n    canDragMove: false,\n    selectedCoordPaths: opts.coordPath ? [opts.coordPath] : []\n  };\n\n  this.setSelectedCoordinates(this.pathsToCoordinates(featureId, state.selectedCoordPaths));\n  this.setSelected(featureId);\n  doubleClickZoom.disable(this);\n\n  this.setActionableState({\n    trash: true\n  });\n\n  return state;\n};\n\nDirectSelect.onStop = function() {\n  doubleClickZoom.enable(this);\n  this.clearSelectedCoordinates();\n};\n\nDirectSelect.toDisplayFeatures = function(state, geojson, push) {\n  if (state.featureId === geojson.properties.id) {\n    geojson.properties.active = Constants.activeStates.ACTIVE;\n    push(geojson);\n    createSupplementaryPoints(geojson, {\n      map: this.map,\n      midpoints: true,\n      selectedPaths: state.selectedCoordPaths\n    }).forEach(push);\n  } else {\n    geojson.properties.active = Constants.activeStates.INACTIVE;\n    push(geojson);\n  }\n  this.fireActionable(state);\n};\n\nDirectSelect.onTrash = function(state) {\n  state.selectedCoordPaths.sort().reverse().forEach(id => state.feature.removeCoordinate(id));\n  this.fireUpdate();\n  state.selectedCoordPaths = [];\n  this.clearSelectedCoordinates();\n  this.fireActionable(state);\n  if (state.feature.isValid() === false) {\n    this.deleteFeature([state.featureId]);\n    this.changeMode(Constants.modes.SIMPLE_SELECT, {});\n  }\n};\n\nDirectSelect.onMouseMove = function(state, e) {\n  // On mousemove that is not a drag, stop vertex movement.\n  const isFeature = CommonSelectors.isActiveFeature(e);\n  const onVertex = isVertex(e);\n  const noCoords = state.selectedCoordPaths.length === 0;\n  if (isFeature && noCoords) this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else if (onVertex && !noCoords) this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  else this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  this.stopDragging(state);\n};\n\nDirectSelect.onMouseOut = function(state) {\n  // As soon as you mouse leaves the canvas, update the feature\n  if (state.dragMoving) this.fireUpdate();\n};\n\nDirectSelect.onTouchStart = DirectSelect.onMouseDown = function(state, e) {\n  if (isVertex(e)) return this.onVertex(state, e);\n  if (CommonSelectors.isActiveFeature(e)) return this.onFeature(state, e);\n  if (isMidpoint(e)) return this.onMidpoint(state, e);\n};\n\nDirectSelect.onDrag = function(state, e) {\n  if (state.canDragMove !== true) return;\n  state.dragMoving = true;\n  e.originalEvent.stopPropagation();\n\n  const delta = {\n    lng: e.lngLat.lng - state.dragMoveLocation.lng,\n    lat: e.lngLat.lat - state.dragMoveLocation.lat\n  };\n  if (state.selectedCoordPaths.length > 0) this.dragVertex(state, e, delta);\n  else this.dragFeature(state, e, delta);\n\n  state.dragMoveLocation = e.lngLat;\n};\n\nDirectSelect.onClick = function(state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (CommonSelectors.isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n  this.stopDragging(state);\n};\n\nDirectSelect.onTap = function(state, e) {\n  if (noTarget(e)) return this.clickNoTarget(state, e);\n  if (CommonSelectors.isActiveFeature(e)) return this.clickActiveFeature(state, e);\n  if (isInactiveFeature(e)) return this.clickInactive(state, e);\n};\n\nDirectSelect.onTouchEnd = DirectSelect.onMouseUp = function(state) {\n  if (state.dragMoving) {\n    this.fireUpdate();\n  }\n  this.stopDragging(state);\n};\n\nmodule.exports = DirectSelect;\n\n","const CommonSelectors = require('../lib/common_selectors');\nconst Constants = require('../constants');\n\nconst DrawPoint = {};\n\nDrawPoint.onSetup = function() {\n  const point = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POINT,\n      coordinates: []\n    }\n  });\n\n  this.addFeature(point);\n\n  this.clearSelectedFeatures();\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POINT);\n\n  this.setActionableState({\n    trash: true\n  });\n\n  return { point };\n};\n\nDrawPoint.stopDrawingAndRemove = function(state) {\n  this.deleteFeature([state.point.id], { silent: true });\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDrawPoint.onTap = DrawPoint.onClick = function(state, e) {\n  this.updateUIClasses({ mouse: Constants.cursors.MOVE });\n  state.point.updateCoordinate('', e.lngLat.lng, e.lngLat.lat);\n  this.map.fire(Constants.events.CREATE, {\n    features: [state.point.toGeoJSON()]\n  });\n  this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.point.id] });\n};\n\nDrawPoint.onStop = function(state) {\n  this.activateUIButton();\n  if (!state.point.getCoordinate().length) {\n    this.deleteFeature([state.point.id], { silent: true });\n  }\n};\n\nDrawPoint.toDisplayFeatures = function(state, geojson, display) {\n  // Never render the point we're drawing\n  const isActivePoint = geojson.properties.id === state.point.id;\n  geojson.properties.active = (isActivePoint) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  if (!isActivePoint) return display(geojson);\n};\n\nDrawPoint.onTrash = DrawPoint.stopDrawingAndRemove;\n\nDrawPoint.onKeyUp = function(state, e) {\n  if (CommonSelectors.isEscapeKey(e) || CommonSelectors.isEnterKey(e)) {\n    return this.stopDrawingAndRemove(state, e);\n  }\n};\n\nmodule.exports = DrawPoint;\n","function isEventAtCoordinates(event, coordinates) {\n  if (!event.lngLat) return false;\n  return event.lngLat.lng === coordinates[0] && event.lngLat.lat === coordinates[1];\n}\n\nmodule.exports = isEventAtCoordinates;\n","const CommonSelectors = require('../lib/common_selectors');\nconst doubleClickZoom = require('../lib/double_click_zoom');\nconst Constants = require('../constants');\nconst isEventAtCoordinates = require('../lib/is_event_at_coordinates');\nconst createVertex = require('../lib/create_vertex');\n\nconst DrawPolygon = {};\n\nDrawPolygon.onSetup = function() {\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {},\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]]\n    }\n  });\n\n  this.addFeature(polygon);\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true\n  });\n\n  return {\n    polygon,\n    currentVertexPosition: 0\n  };\n};\n\nDrawPolygon.clickAnywhere = function(state, e) {\n  if (state.currentVertexPosition > 0 && isEventAtCoordinates(e, state.polygon.coordinates[0][state.currentVertexPosition - 1])) {\n    return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n  }\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  state.polygon.updateCoordinate(`0.${state.currentVertexPosition}`, e.lngLat.lng, e.lngLat.lat);\n  state.currentVertexPosition++;\n  state.polygon.updateCoordinate(`0.${state.currentVertexPosition}`, e.lngLat.lng, e.lngLat.lat);\n};\n\nDrawPolygon.clickOnVertex = function(state) {\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n};\n\nDrawPolygon.onMouseMove = function(state, e) {\n  state.polygon.updateCoordinate(`0.${state.currentVertexPosition}`, e.lngLat.lng, e.lngLat.lat);\n  if (CommonSelectors.isVertex(e)) {\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n  }\n};\n\nDrawPolygon.onTap = DrawPolygon.onClick = function(state, e) {\n  if (CommonSelectors.isVertex(e)) return this.clickOnVertex(state, e);\n  return this.clickAnywhere(state, e);\n};\n\nDrawPolygon.onKeyUp = function(state, e) {\n  if (CommonSelectors.isEscapeKey(e)) {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT);\n  } else if (CommonSelectors.isEnterKey(e)) {\n    this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.polygon.id] });\n  }\n};\n\nDrawPolygon.onStop = function(state) {\n  this.updateUIClasses({ mouse: Constants.cursors.NONE });\n  doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.polygon.id) === undefined) return;\n\n  //remove last added coordinate\n  state.polygon.removeCoordinate(`0.${state.currentVertexPosition}`);\n  if (state.polygon.isValid()) {\n    this.map.fire(Constants.events.CREATE, {\n      features: [state.polygon.toGeoJSON()]\n    });\n  } else {\n    this.deleteFeature([state.polygon.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT, {}, { silent: true });\n  }\n};\n\nDrawPolygon.toDisplayFeatures = function(state, geojson, display) {\n  const isActivePolygon = geojson.properties.id === state.polygon.id;\n  geojson.properties.active = (isActivePolygon) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  if (!isActivePolygon) return display(geojson);\n\n  // Don't render a polygon until it has two positions\n  // (and a 3rd which is just the first repeated)\n  if (geojson.geometry.coordinates.length === 0) return;\n\n  const coordinateCount = geojson.geometry.coordinates[0].length;\n  // 2 coordinates after selecting a draw type\n  // 3 after creating the first point\n  if (coordinateCount < 3) {\n    return;\n  }\n  geojson.properties.meta = Constants.meta.FEATURE;\n  display(createVertex(state.polygon.id, geojson.geometry.coordinates[0][0], '0.0', false));\n  if (coordinateCount > 3) {\n    // Add a start position marker to the map, clicking on this will finish the feature\n    // This should only be shown when we're in a valid spot\n    const endPos = geojson.geometry.coordinates[0].length - 3;\n    display(createVertex(state.polygon.id, geojson.geometry.coordinates[0][endPos], `0.${endPos}`, false));\n  }\n  if (coordinateCount <= 4) {\n    // If we've only drawn two positions (plus the closer),\n    // make a LineString instead of a Polygon\n    const lineCoordinates = [\n      [geojson.geometry.coordinates[0][0][0], geojson.geometry.coordinates[0][0][1]], [geojson.geometry.coordinates[0][1][0], geojson.geometry.coordinates[0][1][1]]\n    ];\n    // create an initial vertex so that we can track the first point on mobile devices\n    display({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: geojson.properties,\n      geometry: {\n        coordinates: lineCoordinates,\n        type: Constants.geojsonTypes.LINE_STRING\n      }\n    });\n    if (coordinateCount === 3) {\n      return;\n    }\n  }\n  // render the Polygon\n  return display(geojson);\n};\n\nDrawPolygon.onTrash = function(state) {\n  this.deleteFeature([state.polygon.id], { silent: true });\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nmodule.exports = DrawPolygon;\n","const CommonSelectors = require('../lib/common_selectors');\nconst isEventAtCoordinates = require('../lib/is_event_at_coordinates');\nconst doubleClickZoom = require('../lib/double_click_zoom');\nconst Constants = require('../constants');\nconst createVertex = require('../lib/create_vertex');\n\nconst DrawLineString = {};\n\nDrawLineString.onSetup = function(opts) {\n  opts = opts || {};\n  const featureId = opts.featureId;\n\n  let line, currentVertexPosition;\n  let direction = 'forward';\n  if (featureId) {\n    line = this.getFeature(featureId);\n    if (!line) {\n      throw new Error('Could not find a feature with the provided featureId');\n    }\n    let from = opts.from;\n    if (from && from.type === 'Feature' && from.geometry && from.geometry.type === 'Point') {\n      from = from.geometry;\n    }\n    if (from && from.type === 'Point' && from.coordinates && from.coordinates.length === 2) {\n      from = from.coordinates;\n    }\n    if (!from || !Array.isArray(from)) {\n      throw new Error('Please use the `from` property to indicate which point to continue the line from');\n    }\n    const lastCoord = line.coordinates.length - 1;\n    if (line.coordinates[lastCoord][0] === from[0] && line.coordinates[lastCoord][1] === from[1]) {\n      currentVertexPosition = lastCoord + 1;\n      // add one new coordinate to continue from\n      line.addCoordinate(currentVertexPosition, ...line.coordinates[lastCoord]);\n    } else if (line.coordinates[0][0] === from[0] && line.coordinates[0][1] === from[1]) {\n      direction = 'backwards';\n      currentVertexPosition = 0;\n      // add one new coordinate to continue from\n      line.addCoordinate(currentVertexPosition, ...line.coordinates[0]);\n    } else {\n      throw new Error('`from` should match the point at either the start or the end of the provided LineString');\n    }\n  } else {\n    line = this.newFeature({\n      type: Constants.geojsonTypes.FEATURE,\n      properties: {},\n      geometry: {\n        type: Constants.geojsonTypes.LINE_STRING,\n        coordinates: []\n      }\n    });\n    currentVertexPosition = 0;\n    this.addFeature(line);\n  }\n\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  this.activateUIButton(Constants.types.LINE);\n  this.setActionableState({\n    trash: true\n  });\n\n  return {\n    line,\n    currentVertexPosition,\n    direction\n  };\n};\n\nDrawLineString.clickAnywhere = function(state, e) {\n  if (state.currentVertexPosition > 0 && isEventAtCoordinates(e, state.line.coordinates[state.currentVertexPosition - 1]) ||\n      state.direction === 'backwards' && isEventAtCoordinates(e, state.line.coordinates[state.currentVertexPosition + 1])) {\n    return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.line.id] });\n  }\n  this.updateUIClasses({ mouse: Constants.cursors.ADD });\n  state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  if (state.direction === 'forward') {\n    state.currentVertexPosition++;\n    state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  } else {\n    state.line.addCoordinate(0, e.lngLat.lng, e.lngLat.lat);\n  }\n};\n\nDrawLineString.clickOnVertex = function(state) {\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.line.id] });\n};\n\nDrawLineString.onMouseMove = function(state, e) {\n  state.line.updateCoordinate(state.currentVertexPosition, e.lngLat.lng, e.lngLat.lat);\n  if (CommonSelectors.isVertex(e)) {\n    this.updateUIClasses({ mouse: Constants.cursors.POINTER });\n  }\n};\n\nDrawLineString.onTap = DrawLineString.onClick = function(state, e) {\n  if (CommonSelectors.isVertex(e)) return this.clickOnVertex(state, e);\n  this.clickAnywhere(state, e);\n};\n\nDrawLineString.onKeyUp = function(state, e) {\n  if (CommonSelectors.isEnterKey(e)) {\n    this.changeMode(Constants.modes.SIMPLE_SELECT, { featureIds: [state.line.id] });\n  } else if (CommonSelectors.isEscapeKey(e)) {\n    this.deleteFeature([state.line.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT);\n  }\n};\n\nDrawLineString.onStop = function(state) {\n  doubleClickZoom.enable(this);\n  this.activateUIButton();\n\n  // check to see if we've deleted this feature\n  if (this.getFeature(state.line.id) === undefined) return;\n\n  //remove last added coordinate\n  state.line.removeCoordinate(`${state.currentVertexPosition}`);\n  if (state.line.isValid()) {\n    this.map.fire(Constants.events.CREATE, {\n      features: [state.line.toGeoJSON()]\n    });\n  } else {\n    this.deleteFeature([state.line.id], { silent: true });\n    this.changeMode(Constants.modes.SIMPLE_SELECT, {}, { silent: true });\n  }\n};\n\nDrawLineString.onTrash = function(state) {\n  this.deleteFeature([state.line.id], { silent: true });\n  this.changeMode(Constants.modes.SIMPLE_SELECT);\n};\n\nDrawLineString.toDisplayFeatures = function(state, geojson, display) {\n  const isActiveLine = geojson.properties.id === state.line.id;\n  geojson.properties.active = (isActiveLine) ? Constants.activeStates.ACTIVE : Constants.activeStates.INACTIVE;\n  if (!isActiveLine) return display(geojson);\n  // Only render the line if it has at least one real coordinate\n  if (geojson.geometry.coordinates.length < 2) return;\n  geojson.properties.meta = Constants.meta.FEATURE;\n  display(createVertex(\n    state.line.id,\n    geojson.geometry.coordinates[state.direction === 'forward' ? geojson.geometry.coordinates.length - 2 : 1],\n    `${state.direction === 'forward' ? geojson.geometry.coordinates.length - 2 : 1}`,\n    false\n  ));\n\n  display(geojson);\n};\n\nmodule.exports = DrawLineString;\n","module.exports = {\n  simple_select: require('./simple_select'),\n  direct_select: require('./direct_select'),\n  draw_point: require('./draw_point'),\n  draw_polygon: require('./draw_polygon'),\n  draw_line_string: require('./draw_line_string'),\n};\n","// @flow\n\nimport * as React from 'react';\nimport { MapContext } from '@urbica/react-map-gl';\nimport MapboxDraw from '@mapbox/mapbox-gl-draw/dist/mapbox-gl-draw';\nimport theme from '@mapbox/mapbox-gl-draw/src/lib/theme';\nimport modes from '@mapbox/mapbox-gl-draw/src/modes';\n\nexport type Props = {\n  /** Draw controls position */\n  position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right',\n\n  /** Whether or not to enable keyboard interactions for drawing. */\n  keybindings?: boolean,\n\n  /** Whether or not to enable touch interactions for drawing. */\n  touchEnabled?: boolean,\n\n  /**\n   * Whether or not to enable box selection of features with shift+click+drag.\n   * If false, shift+click+drag zooms into an area.\n   */\n  boxSelect?: boolean,\n\n  /**\n   * Number of pixels around any feature or vertex (in every direction)\n   * that will respond to a click.\n   */\n  clickBuffer?: number,\n\n  /**\n   * Number of pixels around any feature of vertex (in every direction)\n   * that will respond to a touch.\n   */\n  touchBuffer?: number,\n\n  /** Hide or show Point Control. */\n  pointControl?: boolean,\n\n  /** Hide or show Line String Control. */\n  lineStringControl?: boolean,\n\n  /** Hide or show Polygon Control. */\n  polygonControl?: boolean,\n\n  /** Hide or show Trash Control. */\n  trashControl?: boolean,\n\n  /** Hide or show Combine Features Control. */\n  combineFeaturesControl?: boolean,\n\n  /** Hide or show Uncombine Features Control. */\n  uncombineFeaturesControl?: boolean,\n\n  /**\n   *  The default value for controls. For example, if you would like all\n   *  controls to be off by default, and specify a whitelist with controls,\n   *  use displayControlsDefault: false.\n   */\n  displayControlsDefault?: boolean,\n\n  /** An array of map style objects. */\n  styles?: Array<Object>,\n\n  /** Over ride the default modes with your own. */\n  modes?: Object,\n\n  /** The mode that will used. */\n  mode?: String,\n\n  /** The mode options. */\n  modeOptions?: Object,\n\n  /**\n   * Properties of a feature will also be available for styling\n   * and prefixed with user_, e.g., ['==', 'user_custom_label', 'Example']\n   */\n  userProperties?: boolean,\n\n  /** Valid geoJSON to edit with Draw. */\n  data?: Object,\n\n  /**\n   * Fired when a feature is created.\n   * The following interactions will trigger this event:\n   * • Finish drawing a feature. Simply clicking will create a Point.\n   *   A LineString or Polygon is only created when the user\n   *   has finished drawing it — i.e. double-clicked the last vertex\n   *   or hit Enter — and the drawn feature is valid.\n   */\n  onDrawCreate?: Function,\n\n  /**\n   * Fired when one or more features are deleted.\n   * The following interactions will trigger this event:\n   * • Click the trash button when one or more features are selected\n   *   in simple_select mode.\n   * • Hit the Backspace or Delete keys when one or features are selected\n   *   in simple_select mode.\n   * • Invoke draw.trash() when you have a feature selected in\n   *   simple_select mode.\n   */\n  onDrawDelete?: Function,\n\n  /**\n   * Fired when features are combined. The following interactions will\n   * trigger this event:\n   * • Click the Combine button when more than one features are selected\n   *   in simple_select mode.\n   * • Invoke draw.combineFeatures() when more than one features are selected\n   *   in simple_select mode.\n   */\n  onDrawCombine?: Function,\n\n  /**\n   * Fired when features are uncombined. The following interactions will\n   * trigger this event:\n   * • Click the Uncombine button when one or more multifeatures are selected\n   *   in simple_select mode. Non-multifeatures may also be selected.\n   * • Invoke draw.uncombineFeatures() when one or more multifeatures are\n   *   selected in simple_select mode. Non-multifeatures may also be selected.\n   */\n  onDrawUncombine?: Function,\n\n  /**\n   * Fired when one or more features are updated. The following interactions\n   * will trigger this event, which can be subcategorized by action:\n   * • `action: 'move'`\n   *   • Finish moving one or more selected features in `simple_select` mode.\n   *      The event will only fire when the movement is finished\n   *      (i.e. when the user releases the mouse button or hits Enter).\n   * • `action: 'change_coordinates'`\n   *   • Finish moving one or more vertices of a selected feature in\n   *     `direct_select` mode. The event will only fire when the movement\n   *     is finished (i.e. when the user releases the mouse button or\n   *     hits Enter, or her mouse leaves the map container).\n   *   • Delete one or more vertices of a selected feature in `direct_select`\n   *     mode, which can be done by hitting the Backspace or Delete keys,\n   *     clicking the Trash button, or invoking draw.trash().\n   *   • Add a vertex to the selected feature by clicking a midpoint on that\n   *     feature in direct_select mode.\n   * This event will not fire when a feature is created or deleted. To track\n   * those interactions, listen for draw.create and draw.delete events.\n   */\n  onDrawUpdate?: Function,\n\n  /**\n   * Fired when the selection is changed (i.e. one or more features are selected\n   * or deselected). The following interactions will trigger this event:\n   * • Click on a feature to select it.\n   * • When a feature is already selected, shift-click on another feature to add\n   *   it to the selection.\n   * • Click on a vertex to select it.\n   * • When a vertex is already selected, shift-click on another vertex to add\n   *   it to the selection.\n   * • Create a box-selection that includes at least one feature.\n   * • Click outside the selected feature(s) to deselect.\n   * • Click away from the selected vertex(s) to deselect.\n   * • Finish drawing a feature (features are selected just after they are\n   *   created).\n   * • When a feature is already selected, invoke draw.changeMode() such that\n   *   the feature becomes deselected.\n   * • Use `draw.changeMode('simple_select', { featureIds: [..] })` to switch to\n   *   `simple_select` mode and immediately select the specified features.\n   * • Use `draw.delete`, `draw.deleteAll` or `draw.trash` to delete feature(s).\n   */\n  onDrawSelectionChange?: Function,\n\n  /**\n   * Fired when the mode is changed. The following interactions will trigger\n   * this event:\n   * • Click the point, line, or polygon buttons to begin drawing (enter a\n   *   `draw_*` mode).\n   * • Finish drawing a feature (enter `simple_select` mode).\n   * • While in `simple_select` mode, click on an already selected feature\n   *   (enter `direct_select` mode).\n   * • While in `direct_select` mode, click outside all features (enter\n   *   `simple_select` mode).\n   * This event is fired just after the current mode stops and just before\n   * the next mode starts. A render will not happen until after all event\n   * handlers have been triggered, so you can force a mode redirect by calling\n   * `draw.changeMode()` inside a `draw.modechange` handler.\n   */\n  onDrawModeChange?: Function,\n\n  /**\n   * Fired just after Draw calls `setData()` on the Mapbox GL JS map. This does\n   * not imply that the set data call has finished updating the map, just that\n   * the map is being updated.\n   */\n  onDrawRender?: Function,\n\n  /**\n   * Fired as the state of Draw changes to enable and disable different actions.\n   * Following this event will enable you know if `draw.trash()`,\n   * `draw.combineFeatures()` and draw.uncombineFeatures() will have an effect.\n   */\n  onDrawActionable?: Function,\n\n  /**\n   * Fired when features are changed. (`draw.create`, `draw.delete`,\n   * `draw.combine`, `draw.uncombine`, `draw.update`).\n   */\n  onChange?: Function,\n  customControls?: Object,\n};\n\nclass Draw extends React.PureComponent<Props> {\n  static defaultProps = {\n    position: 'top-right',\n    keybindings: true,\n    touchEnabled: true,\n    boxSelect: true,\n    clickBuffer: 2,\n    touchBuffer: 25,\n    pointControl: true,\n    lineStringControl: true,\n    polygonControl: true,\n    trashControl: true,\n    combineFeaturesControl: true,\n    uncombineFeaturesControl: true,\n    displayControlsDefault: true,\n    styles: theme,\n    modes,\n    mode: 'simple_select',\n    modeOptions: {},\n    userProperties: false,\n    data: null,\n    onDrawCreate: null,\n    onDrawDelete: null,\n    onDrawCombine: null,\n    onDrawUncombine: null,\n    onDrawUpdate: null,\n    onDrawSelectionChange: null,\n    onDrawModeChange: null,\n    onDrawRender: null,\n    onDrawActionable: null,\n    onChange: null,\n    customControls: {}\n  };\n\n  componentDidMount() {\n    // $FlowFixMe\n    const map = this._map;\n    const draw = new MapboxDraw({\n      keybindings: this.props.keybindings,\n      touchEnabled: this.props.touchEnabled,\n      boxSelect: this.props.boxSelect,\n      clickBuffer: this.props.clickBuffer,\n      touchBuffer: this.props.touchBuffer,\n      controls: {\n        point: this.props.pointControl,\n        line_string: this.props.lineStringControl,\n        polygon: this.props.polygonControl,\n        trash: this.props.trashControl,\n        combine_features: this.props.combineFeaturesControl,\n        uncombine_features: this.props.uncombineFeaturesControl,\n        ...this.props.customControls\n      },\n      displayControlsDefault: this.props.displayControlsDefault,\n      styles: this.props.styles,\n      modes: this.props.modes,\n      defaultMode: this.props.mode,\n      userProperties: this.props.userProperties\n    }, this.props.position);\n\n    map.addControl(draw);\n    map.on('draw.create', this._onDrawCreate);\n    map.on('draw.create', this._onChange);\n    map.on('draw.delete', this._onDrawDelete);\n    map.on('draw.delete', this._onChange);\n    map.on('draw.combine', this._onDrawCombine);\n    map.on('draw.combine', this._onChange);\n    map.on('draw.uncombine', this._onDrawUncombine);\n    map.on('draw.uncombine', this._onChange);\n    map.on('draw.update', this._onDrawUpdate);\n    map.on('draw.update', this._onChange);\n    map.on('draw.selectionchange', this._onDrawSelectionchange);\n    map.on('draw.modechange', this._onDrawModechange);\n    map.on('draw.render', this._onDrawRender);\n    map.on('draw.actionable', this._onDrawActionable);\n\n    if (this.props.data) {\n      draw.add(this.props.data);\n    }\n\n    // $FlowFixMe\n    this._draw = draw;\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.data) {\n      // $FlowFixMe\n      this._draw.set(this.props.data);\n    }\n\n    if (prevProps.mode !== this.props.mode) {\n      // $FlowFixMe\n      this._draw.changeMode(this.props.mode, this.props.modeOptions);\n    }\n  }\n\n  componentWillUnmount(): void {\n    // $FlowFixMe\n    if (!this._map || !this._map.getStyle()) {\n      return;\n    }\n\n    // $FlowFixMe\n    this._draw.onRemove();\n  }\n\n  getDraw() {\n    // $FlowFixMe\n    return this._draw;\n  }\n\n  _onChange = () => {\n    const { onChange } = this.props;\n\n    if (onChange) {\n      // $FlowFixMe\n      const allFeatures = this._draw.getAll();\n      onChange(allFeatures);\n    }\n  };\n\n  _onDrawCreate = (event: Object) => {\n    if (this.props.onDrawCreate) {\n      this.props.onDrawCreate(event);\n    }\n  };\n\n  _onDrawDelete = (event: Object) => {\n    if (this.props.onDrawDelete) {\n      this.props.onDrawDelete(event);\n    }\n  };\n\n  _onDrawCombine = (event: Object) => {\n    if (this.props.onDrawCombine) {\n      this.props.onDrawCombine(event);\n    }\n  };\n\n  _onDrawUncombine = (event: Object) => {\n    if (this.props.onDrawUncombine) {\n      this.props.onDrawUncombine(event);\n    }\n  };\n\n  _onDrawUpdate = (event: Object) => {\n    if (this.props.onDrawUpdate) {\n      this.props.onDrawUpdate(event);\n    }\n  };\n\n  _onDrawSelectionchange = (event: Object) => {\n    if (this.props.onDrawSelectionChange) {\n      this.props.onDrawSelectionChange(event);\n    }\n  };\n\n  _onDrawModechange = (event: Object) => {\n    if (this.props.onDrawModeChange) {\n      this.props.onDrawModeChange(event);\n    }\n  };\n\n  _onDrawRender = (event: Object) => {\n    if (this.props.onDrawRender) {\n      this.props.onDrawRender(event);\n    }\n  };\n\n  _onDrawActionable = (event: Object) => {\n    if (this.props.onDrawActionable) {\n      this.props.onDrawActionable(event);\n    }\n  };\n\n  render() {\n    return React.createElement(MapContext.Consumer, {}, (map) => {\n      if (map) {\n        // $FlowFixMe\n        this._map = map;\n      }\n      return null;\n    });\n  }\n}\n\nexport default Draw;\n"],"names":["module","classes","CONTROL_BASE","CONTROL_PREFIX","CONTROL_BUTTON","CONTROL_BUTTON_LINE","CONTROL_BUTTON_POLYGON","CONTROL_BUTTON_POINT","CONTROL_BUTTON_TRASH","CONTROL_BUTTON_COMBINE_FEATURES","CONTROL_BUTTON_UNCOMBINE_FEATURES","CONTROL_GROUP","ATTRIBUTION","ACTIVE_BUTTON","BOX_SELECT","sources","HOT","COLD","cursors","ADD","MOVE","DRAG","POINTER","NONE","types","POLYGON","LINE","POINT","geojsonTypes","FEATURE","LINE_STRING","FEATURE_COLLECTION","MULTI_PREFIX","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","modes","DRAW_LINE_STRING","DRAW_POLYGON","DRAW_POINT","SIMPLE_SELECT","DIRECT_SELECT","STATIC","events","CREATE","DELETE","UPDATE","SELECTION_CHANGE","MODE_CHANGE","ACTIONABLE","RENDER","COMBINE_FEATURES","UNCOMBINE_FEATURES","updateActions","CHANGE_COORDINATES","meta","MIDPOINT","VERTEX","activeStates","ACTIVE","INACTIVE","interactions","LAT_MIN","LAT_RENDERED_MIN","LAT_MAX","LAT_RENDERED_MAX","LNG_MIN","LNG_MAX","isOfMetaType","type","e","featureTarget","properties","isShiftMousedown","originalEvent","shiftKey","button","isActiveFeature","active","Constants","isInactiveFeature","noTarget","undefined","isFeature","isVertex","isShiftDown","isEscapeKey","keyCode","isEnterKey","true","Point","x","y","prototype","clone","add","p","_add","sub","_sub","multByPoint","_multByPoint","divByPoint","_divByPoint","mult","k","_mult","div","_div","rotate","a","_rotate","rotateAround","_rotateAround","matMult","m","_matMult","unit","_unit","perp","_perp","round","_round","mag","Math","sqrt","equals","other","dist","distSqr","dx","dy","angle","atan2","angleTo","b","angleWith","angleWithSep","cos","sin","convert","Array","isArray","mouseEventPoint","mouseEvent","container","rect","getBoundingClientRect","clientX","left","clientLeft","clientY","top","clientTop","parentId","coordinates","path","selected","parent","coord_path","geometry","startVertex","endVertex","map","startCoord","endCoord","ptA","project","ptB","mid","unproject","lng","lat","createSupplementaryPoints","geojson","options","basePath","featureId","id","supplementaryPoints","push","createVertex","isSelectedPath","forEach","line","lineIndex","processLine","String","indexOf","processMultiGeometry","lineBasePath","firstPointString","lastVertex","point","pointIndex","pointPath","vertex","midpoints","midpoint","createMidpoint","stringifiedPoint","JSON","stringify","selectedPaths","subType","replace","subCoordinates","index","subFeature","concat","StringSet","items","_items","_nums","_length","length","i","l","has","delete","values","Object","keys","v","parse","sort","clear","enable","ctx","setTimeout","doubleClickZoom","_ctx","store","getInitialConfigValue","disable","normalize","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection","Feature","FeatureCollection","gj","features","flatten","reduce","mem","feature","geom","data","_","geometries","memo","geoms","list","_flatten","acc","item","normalized","geojsonFlatten","geojsonNormalize","traverse","obj","Traverse","value","get","ps","node","key","hasOwnProperty","call","set","cb","walk","init","skip","arguments","isRoot","paths","nodes","parents","src","dst","copy","objectKeys","pop","root","immutable","alive","walker","node_","modifiers","keepGoing","state","slice","level","circular","update","stopHere","remove","splice","before","f","after","pre","post","stop","block","updateState","isLeaf","notLeaf","notRoot","ret","child","isLast","isFirst","isDate","Date","getTime","isRegExp","RegExp","isError","message","isBoolean","Boolean","isNumber","Number","isString","create","getPrototypeOf","constructor","proto","__proto__","T","res","toS","toString","xs","fn","args","t","apply","Extent","bbox","_bbox","Infinity","_valid","include","ll","min","max","center","union","contains","_fastContains","lon","intersect","Function","body","polygon","geojsonTypesByDataAttributes","dataAttributes","getExtent","isValid","some","attribute","ext","extent","coords","geojsonCoords","geojsonFeatures","delta","northInnerEdge","southInnerEdge","northOuterEdge","southOuterEdge","westEdge","eastEdge","bounds","featureSouthEdge","featureNorthEdge","featureWestEdge","featureEastEdge","constrainedDelta","ceil","abs","constrainFeatureMovement","toGeoJSON","currentCoordinates","getCoordinates","moveCoordinate","coord","moveRing","ring","moveMultiPolygon","multi","nextCoordinates","incomingCoords","SimpleSelect","onSetup","opts","dragMoveLocation","boxSelectStartLocation","boxSelectElement","boxSelecting","canBoxSelect","dragMoveing","canDragMove","initiallySelectedFeatureIds","featureIds","setSelected","filter","getFeature","fireActionable","setActionableState","combineFeatures","uncombineFeatures","trash","fireUpdate","fire","action","getSelected","selectedFeatures","multiFeatures","isInstanceOf","featureType","getUniqueIds","allFeatures","ids","s","stopExtendedInteractions","parentNode","removeChild","dragPan","dragMoving","onStop","onMouseMove","onMouseOut","onTap","onClick","CommonSelectors","clickAnywhere","clickOnVertex","clickOnFeature","wasSelected","getSelectedIds","clearSelectedFeatures","doRender","changeMode","coordPath","startPos","lngLat","updateUIClasses","mouse","startOnActiveFeature","isShiftClick","selectedFeatureIds","isFeatureSelected","isSelected","deselect","select","onMouseDown","drawConfig","boxSelect","startBoxSelect","getContainer","onTouchStart","onDrag","dragMove","whileBoxSelect","document","createElement","classList","appendChild","current","minX","maxX","minY","maxY","translateValue","style","transform","WebkitTransform","width","height","stopPropagation","moveFeatures","onMouseUp","featuresInBox","featuresAt","idsToSelect","toDisplayFeatures","display","onTrash","deleteFeature","onCombineFeatures","featuresCombined","includes","subcoords","multiFeature","newFeature","addFeature","silent","createdFeatures","deletedFeatures","onUncombineFeatures","featuresUncombined","getFeatures","require","isMidpoint","DirectSelect","selectedCoordPaths","startDragging","stopDragging","onVertex","about","selectedIndex","selectedCoordinates","pathsToCoordinates","setSelectedCoordinates","onMidpoint","addCoordinate","feature_id","onFeature","dragFeature","dragVertex","selectedCoords","getCoordinate","selectedCoordPoints","updateCoordinate","clickNoTarget","clickInactive","clickActiveFeature","clearSelectedCoordinates","changed","Error","TypeError","reverse","removeCoordinate","noCoords","onTouchEnd","DrawPoint","activateUIButton","stopDrawingAndRemove","isActivePoint","onKeyUp","isEventAtCoordinates","event","DrawPolygon","currentVertexPosition","isActivePolygon","coordinateCount","endPos","lineCoordinates","DrawLineString","direction","from","lastCoord","isActiveLine","simple_select","direct_select","draw_point","draw_polygon","draw_line_string","Draw","React","onChange","props","_draw","getAll","onDrawCreate","onDrawDelete","onDrawCombine","onDrawUncombine","onDrawUpdate","onDrawSelectionChange","onDrawModeChange","onDrawRender","onDrawActionable","componentDidMount","_map","draw","MapboxDraw","keybindings","touchEnabled","clickBuffer","touchBuffer","controls","pointControl","line_string","lineStringControl","polygonControl","trashControl","combine_features","combineFeaturesControl","uncombine_features","uncombineFeaturesControl","customControls","displayControlsDefault","styles","defaultMode","mode","userProperties","position","addControl","on","_onDrawCreate","_onChange","_onDrawDelete","_onDrawCombine","_onDrawUncombine","_onDrawUpdate","_onDrawSelectionchange","_onDrawModechange","_onDrawRender","_onDrawActionable","componentDidUpdate","prevProps","modeOptions","componentWillUnmount","getStyle","onRemove","getDraw","render","MapContext","Consumer","theme"],"mappings":"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"}